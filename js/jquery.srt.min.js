function toSeconds(a){var b=0;if(a){var c=a.split(":");for(i=0;i<c.length;i++){b=b*60+parseFloat(c[i].replace(",","."))}}return b}function strip(a){return a.replace(/^\s+|\s+$/g,"")}function playSubtitles(b){audio.play();var a=b.attr("data-audio");var c=b.text();b.text("");c=c.replace(/\r\n|\r|\n/g,"\n");var f={};c=strip(c);var d=c.split("\n\n");for(s in d){st=d[s].split("\n");if(st.length>=2){n=st[0];i=strip(st[1].split(" --> ")[0]);o=strip(st[1].split(" --> ")[1]);t=st[2];if(st.length>2){for(j=3;j<st.length;j++){t+="\n"+st[j]}}is=toSeconds(i);os=toSeconds(o);f[is]={i:i,o:o,t:t}}}var e=-1;ival=setInterval(function(){var h=document.getElementById(a).currentTime;var g=-1;for(s in f){if(s>h){break}g=s}if(g>0){if(g!=e){b.html(f[g].t).hide().fadeInSequence(1000);e=g}else{if(f[g].o<h){b.html("")}}}},100)}function getSubtitlesAndPlay(a){$(a).each(function(){var c=$(this);var b=c.attr("data-audio");if(!b){return}var d=c.attr("data-srt");if(d){$(this).load(d,function(f,g,e){playSubtitles(c)})}else{playSubtitles(c)}})};